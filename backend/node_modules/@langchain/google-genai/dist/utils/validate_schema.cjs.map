{"version":3,"file":"validate_schema.cjs","names":["schema: unknown","toolName?: string","path: string[]"],"sources":["../../src/utils/validate_schema.ts"],"sourcesContent":["export function assertNoEmptyStringEnums(\n  schema: unknown,\n  toolName?: string,\n  path: string[] = []\n): void {\n  if (schema == null || typeof schema !== \"object\") return;\n  const obj = schema as Record<string, unknown>;\n\n  if (Array.isArray(obj.enum)) {\n    if (obj.enum.some((v) => v === \"\")) {\n      const pathStr = path.length ? ` at path \"${path.join(\".\")}\"` : \"\";\n      const toolStr = toolName ? ` in tool \"${toolName}\"` : \"\";\n      throw new Error(\n        `Invalid enum: empty string not allowed${toolStr}${pathStr}. ` +\n          \"Gemini API rejects empty strings in enums.\"\n      );\n    }\n  }\n\n  // Descend into common JSON Schema nests\n  if (\n    obj.type === \"object\" &&\n    obj.properties &&\n    typeof obj.properties === \"object\"\n  ) {\n    for (const [prop, child] of Object.entries(\n      obj.properties as Record<string, unknown>\n    )) {\n      assertNoEmptyStringEnums(child, toolName, [...path, prop]);\n    }\n  }\n\n  if (obj.items) {\n    assertNoEmptyStringEnums(obj.items, toolName, [...path, \"[]\"]);\n  }\n\n  for (const k of [\"anyOf\", \"oneOf\", \"allOf\"]) {\n    const arr = obj[k];\n    if (Array.isArray(arr)) {\n      arr.forEach((child, i) =>\n        assertNoEmptyStringEnums(child, toolName, [...path, `${k}[${i}]`])\n      );\n    }\n  }\n\n  if (\n    obj.additionalProperties &&\n    typeof obj.additionalProperties === \"object\"\n  ) {\n    assertNoEmptyStringEnums(obj.additionalProperties, toolName, [\n      ...path,\n      \"additionalProperties\",\n    ]);\n  }\n}\n"],"mappings":";;AAAA,SAAgB,yBACdA,QACAC,UACAC,OAAiB,CAAE,GACb;AACN,KAAI,UAAU,QAAQ,OAAO,WAAW,SAAU;CAClD,MAAM,MAAM;AAEZ,KAAI,MAAM,QAAQ,IAAI,KAAK,EACzB;MAAI,IAAI,KAAK,KAAK,CAAC,MAAM,MAAM,GAAG,EAAE;GAClC,MAAM,UAAU,KAAK,SAAS,CAAC,UAAU,EAAE,KAAK,KAAK,IAAI,CAAC,CAAC,CAAC,GAAG;GAC/D,MAAM,UAAU,WAAW,CAAC,UAAU,EAAE,SAAS,CAAC,CAAC,GAAG;AACtD,SAAM,IAAI,MACR,CAAC,sCAAsC,EAAE,UAAU,QAAQ,4CAAE,CACf;EAEjD;;AAIH,KACE,IAAI,SAAS,YACb,IAAI,cACJ,OAAO,IAAI,eAAe,SAE1B,MAAK,MAAM,CAAC,MAAM,MAAM,IAAI,OAAO,QACjC,IAAI,WACL,EACC,yBAAyB,OAAO,UAAU,CAAC,GAAG,MAAM,IAAK,EAAC;AAI9D,KAAI,IAAI,OACN,yBAAyB,IAAI,OAAO,UAAU,CAAC,GAAG,MAAM,IAAK,EAAC;AAGhE,MAAK,MAAM,KAAK;EAAC;EAAS;EAAS;CAAQ,GAAE;EAC3C,MAAM,MAAM,IAAI;AAChB,MAAI,MAAM,QAAQ,IAAI,EACpB,IAAI,QAAQ,CAAC,OAAO,MAClB,yBAAyB,OAAO,UAAU,CAAC,GAAG,MAAM,GAAG,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,AAAC,EAAC,CACnE;CAEJ;AAED,KACE,IAAI,wBACJ,OAAO,IAAI,yBAAyB,UAEpC,yBAAyB,IAAI,sBAAsB,UAAU,CAC3D,GAAG,MACH,sBACD,EAAC;AAEL"}